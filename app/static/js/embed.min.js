(function() {
  if (window.ChatbotConfig && window.ChatbotConfig.baseUrl && window.ChatbotConfig.userId) {
      // Đặt cookies trực tiếp từ client
      document.cookie = "session_id=" + generateSessionId() + "; max-age=3600; path=/; domain=157.66.46.53";
      document.cookie = "user_id=" + encodeURIComponent(window.ChatbotConfig.userId) + "; max-age=3600; path=/; domain=157.66.46.53";
      
      // Tạo iframe sau khi đặt cookies
      var iframe = document.createElement('iframe');
      iframe.src = window.ChatbotConfig.baseUrl + "/embed?user_id=" + encodeURIComponent(window.ChatbotConfig.userId);
      iframe.style.width = "100%";
      iframe.style.height = "600px";
      iframe.style.border = "none";
      
      document.addEventListener("DOMContentLoaded", function() {
          document.body.appendChild(iframe);
      });
  } else {
      console.error("ChatbotConfig không được định nghĩa hoặc thiếu baseUrl/userId");
  }

  // Hàm tạo session ID giả lập
  function generateSessionId() {
      return 'session-' + Math.random().toString(36).substr(2, 16);
  }
})();
