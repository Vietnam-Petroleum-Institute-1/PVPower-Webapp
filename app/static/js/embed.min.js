(function() {
  if (window.ChatbotConfig && window.ChatbotConfig.baseUrl && window.ChatbotConfig.userId && window.ChatbotConfig.sessionId) {
      // Đặt cookies trực tiếp từ client với SameSite=None và Secure
      document.cookie = "session_id=" + encodeURIComponent(window.ChatbotConfig.sessionId) + "; max-age=3600; path=/; domain=157.66.46.53;";
      document.cookie = "user_id=" + encodeURIComponent(window.ChatbotConfig.userId) + "; max-age=3600; path=/; domain=157.66.46.53;";
      
      // Tạo iframe sau khi đặt cookies
      var iframe = document.createElement('iframe');
      // Thêm dấu '&' tách biệt các tham số trong URL
      iframe.src = window.ChatbotConfig.baseUrl + "/embed?user_id=" + encodeURIComponent(window.ChatbotConfig.userId) + "&session_id=" + encodeURIComponent(window.ChatbotConfig.sessionId);
      iframe.style.width = "100%";
      iframe.style.height = "600px";
      iframe.style.border = "none";
      
      document.addEventListener("DOMContentLoaded", function() {
          document.body.appendChild(iframe);
      });
  } else {
      console.error("ChatbotConfig không được định nghĩa hoặc thiếu baseUrl/userId/sessionId");
  }
})();
