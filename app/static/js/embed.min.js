(function() {
  if (window.ChatbotConfig && window.ChatbotConfig.baseUrl && window.ChatbotConfig.userId) {
      var xhr = new XMLHttpRequest();
      var url = window.ChatbotConfig.baseUrl + "/embed?user_id=" + encodeURIComponent(window.ChatbotConfig.userId);

      xhr.open("GET", url, true);
      xhr.withCredentials = true; // Cho phép gửi và nhận cookies
      xhr.onreadystatechange = function() {
          if (xhr.readyState === 4 && xhr.status === 200) {
              var iframe = document.createElement('iframe');
              iframe.src = window.ChatbotConfig.baseUrl + "/embed?user_id=" + encodeURIComponent(window.ChatbotConfig.userId);
              iframe.style.width = "100%";
              iframe.style.height = "600px";
              iframe.style.border = "none";
              document.body.appendChild(iframe);
          }
      };
      xhr.send();
  } else {
      console.error("ChatbotConfig không được định nghĩa hoặc thiếu baseUrl/userId");
  }
})();
